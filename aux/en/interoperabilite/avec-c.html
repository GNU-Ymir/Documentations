
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>With C Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism-atelier.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-codeblock-filename/block.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../hello-world/">
            
                <a href="../hello-world/">
            
                    
                    Hello World
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../hello-world/commentaires.html">
            
                <a href="../hello-world/commentaires.html">
            
                    
                    Comments
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../types-primitifs.html">
            
                <a href="../types-primitifs.html">
            
                    
                    Primitive types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../expressions/">
            
                <a href="../expressions/">
            
                    
                    Expressions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../expressions/literaux.html">
            
                <a href="../expressions/literaux.html">
            
                    
                    Literals
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../expressions/variables.html">
            
                <a href="../expressions/variables.html">
            
                    
                    Variables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../expressions/operateurs.html">
            
                <a href="../expressions/operateurs.html">
            
                    
                    Operators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../expressions/arrays.html">
            
                <a href="../expressions/arrays.html">
            
                    
                    Arrays and slices
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../expressions/ranges.html">
            
                <a href="../expressions/ranges.html">
            
                    
                    Ranges
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../expressions/tuples.html">
            
                <a href="../expressions/tuples.html">
            
                    
                    Tuples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../expressions/structures-de-controle.html">
            
                <a href="../expressions/structures-de-controle.html">
            
                    
                    Control structures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../expressions/pattern_matching.html">
            
                <a href="../expressions/pattern_matching.html">
            
                    
                    Pattern maching
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../fonctions/main.html">
            
                <a href="../fonctions/main.html">
            
                    
                    Fonctions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../fonctions/attributs.html">
            
                <a href="../fonctions/attributs.html">
            
                    
                    Attributs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../fonctions/lambdas.html">
            
                <a href="../fonctions/lambdas.html">
            
                    
                    Lambdas
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../types-personnalises/main.html">
            
                <a href="../types-personnalises/main.html">
            
                    
                    Custom types
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../types-personnalises/structures.html">
            
                <a href="../types-personnalises/structures.html">
            
                    
                    Structures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../types-personnalises/unions.html">
            
                <a href="../types-personnalises/unions.html">
            
                    
                    Unions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../types-personnalises/enums.html">
            
                <a href="../types-personnalises/enums.html">
            
                    
                    Enums
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../types-personnalises/objects.html">
            
                <a href="../types-personnalises/objects.html">
            
                    
                    Objects
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.4.1" data-path="../types-personnalises/objects/attrs.html">
            
                <a href="../types-personnalises/objects/attrs.html">
            
                    
                    Attributes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.2" data-path="../types-personnalises/objects/constrs.html">
            
                <a href="../types-personnalises/objects/constrs.html">
            
                    
                    Construction and deconstruction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.3" data-path="../types-personnalises/objects/methods.html">
            
                <a href="../types-personnalises/objects/methods.html">
            
                    
                    Methods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.4" data-path="../types-personnalises/objects/inher.html">
            
                <a href="../types-personnalises/objects/inher.html">
            
                    
                    Inheritance
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../types-personnalises/traits.html">
            
                <a href="../types-personnalises/traits.html">
            
                    
                    Traits
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../modules/main.html">
            
                <a href="../modules/main.html">
            
                    
                    Modules
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../modules/creation.html">
            
                <a href="../modules/creation.html">
            
                    
                    Declaration and filesystems
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../modules/access.html">
            
                <a href="../modules/access.html">
            
                    
                    Access specifiers and visibility
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../templates/main.html">
            
                <a href="../templates/main.html">
            
                    
                    Templates
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../templates/types.html">
            
                <a href="../templates/types.html">
            
                    
                    Types constraints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../templates/value.html">
            
                <a href="../templates/value.html">
            
                    
                    Compile time value
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../templates/operators.html">
            
                <a href="../templates/operators.html">
            
                    
                    Operator overloading
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../errors/main.html">
            
                <a href="../errors/main.html">
            
                    
                    Error handling
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../errors/scope_guards.html">
            
                <a href="../errors/scope_guards.html">
            
                    
                    Scope guards
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" >
            
                <span>
            
                    
                    Macros
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="./">
            
                <a href="./">
            
                    
                    Interoperability
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.11.1" data-path="avec-c.html">
            
                <a href="avec-c.html">
            
                    
                    With C
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" >
            
                <span>
            
                    
                    With C++
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" >
            
                <span>
            
                    
                    With D
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >With C</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="with-c">With C</h1>
<p>It would be sensless, to ignore the vast array of C API&apos;s available, that&apos;s why <strong>Ymir</strong> is designed to fit perfectly with C language.</p>
<h2 id="calling-c-function">Calling C function</h2>
<p>The <code class="language-">extern (C)</code> keyword allows you to declare extern C function.</p>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">extern</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token function">pow</span> <span class="token punctuation">(</span>base <span class="token punctuation">:</span> double<span class="token punctuation">,</span> exponent <span class="token punctuation">:</span> double<span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> double<span class="token punctuation">;</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;7 ^ 3 = &quot;</span><span class="token punctuation">,</span> <span class="token function">pow</span> <span class="token punctuation">(</span><span class="token number">7.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Ymir knows how C function names are mangled, and the correct C calling convention.</p>
<h2 id="passing-ymir-array-to-c-function">Passing Ymir array to C function</h2>
<p>In C, arrays are passed to functions as pointer, even if the function says it&apos;s an array. In Ymir arrays with an imutable size are passed by value, when in C they are passed by reference. Thus the function prototype must be changed to match with C expectations.</p>
<p>Ymir and C function prototype equivalence :</p>
<table>
<thead>
<tr>
<th>#</th>
<th>Ymir Type</th>
<th>C Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.</td>
<td>p!T</td>
<td>T[]</td>
</tr>
<tr>
<td>2.</td>
<td>ref [T ; dim]</td>
<td>T[dim]</td>
</tr>
</tbody>
</table>
<h2 id="structs-and-unions">Structs And Unions</h2>
<p>Ymir structs and unions are analog to C ones.</p>
<h2 id="accessing-c-globals">Accessing C globals</h2>
<p>C globals have the C naming convention, so they must be declared as <code class="language-">extern (C)</code>.</p>
<pre class="language-"><code class="lang-ymir"><span class="token comment">/*
 * C file : 
 * int x;
 *
 */</span>
<span class="token keyword">extern</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> x <span class="token punctuation">:</span> int<span class="token punctuation">;</span>
</code></pre>
<h2 id="call-ymir-from-c-language">Call Ymir from C language</h2>
<p>The functions defined in the language <strong>Ymir</strong> will be renamed at compile time, in order to avoid symbol conflicts when editing links. It is possible to force the naming of the function in the same way as C, in order to be able to refer to it in a C program.</p>
<div class="panel-default"> <div class="code-filename"> <p>foo.yr</p></div>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">extern</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">def</span> <span class="token function">foo</span> <span class="token punctuation">(</span>a <span class="token punctuation">:</span> i32<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;In function foo : &quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>    

<span class="token punctuation">}</span>
</code></pre></div>
<div class="panel-default"> <div class="code-filename"> <p>main.c</p></div>
<pre class="language-"><code class="lang-c"><span class="token keyword">void</span> foo <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

def main <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    foo <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>The compilation is then done as follows: </p>
<pre class="language-"><code class="lang-bash">$ gyc -c foo.yr
$ gcc main.c foo.o
$ ./a.out
In <span class="token keyword">function</span> foo <span class="token keyword">:</span> 10
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Interoperability">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"With C","level":"1.11.1","depth":2,"next":{"title":"With C++","level":"1.11.2","depth":2,"ref":"","articles":[]},"previous":{"title":"Interoperability","level":"1.11","depth":1,"path":"interoperabilite/README.md","ref":"interoperabilite/README.md","articles":[{"title":"With C","level":"1.11.1","depth":2,"path":"interoperabilite/avec-c.md","ref":"interoperabilite/avec-c.md","articles":[]},{"title":"With C++","level":"1.11.2","depth":2,"ref":"","articles":[]},{"title":"With D","level":"1.11.3","depth":2,"ref":"","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["prism","-highlight","copy-code-button","mathjax","codeblock-filename"],"pluginsConfig":{"prism":{"css":["prismjs/themes/prism-atelier.css"]},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"codeblock-filename":{},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"copy-code-button":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"interoperabilite/avec-c.md","mtime":"2018-12-01T18:38:32.810Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-12-01T18:39:00.470Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

