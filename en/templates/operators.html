
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Operator overloading Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/code.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-codeblock-filename/block.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-spoiler/spoiler.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-language-picker/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchor-nav-x/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../errors/main.html" />
    
    
    <link rel="prev" href="values.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../hello-world/">
            
                <a href="../hello-world/">
            
                    
                    Hello World
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../hello-world/commentaires.html">
            
                <a href="../hello-world/commentaires.html">
            
                    
                    Comments
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../primitives/">
            
                <a href="../primitives/">
            
                    
                    Basic programming concepts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../primitives/variables.html">
            
                <a href="../primitives/variables.html">
            
                    
                    Variable and Mutability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../primitives/types.html">
            
                <a href="../primitives/types.html">
            
                    
                    Data types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../primitives/functions.html">
            
                <a href="../primitives/functions.html">
            
                    
                    Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../primitives/control.html">
            
                <a href="../primitives/control.html">
            
                    
                    Control flows
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../advanced/">
            
                <a href="../advanced/">
            
                    
                    Alias and References
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../advanced/references.html">
            
                <a href="../advanced/references.html">
            
                    
                    References
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../advanced/alias.html">
            
                <a href="../advanced/alias.html">
            
                    
                    Aliases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../advanced/copies.html">
            
                <a href="../advanced/copies.html">
            
                    
                    Copy and Deep copy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../types/">
            
                <a href="../types/">
            
                    
                    User defined types
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../types/struct.html">
            
                <a href="../types/struct.html">
            
                    
                    Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../types/enum.html">
            
                <a href="../types/enum.html">
            
                    
                    Enum
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../modules/">
            
                <a href="../modules/">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../objects/">
            
                <a href="../objects/">
            
                    
                    Objects
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../objects/class.html">
            
                <a href="../objects/class.html">
            
                    
                    Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../objects/inheritance.html">
            
                <a href="../objects/inheritance.html">
            
                    
                    Inheritance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../objects/traits.html">
            
                <a href="../objects/traits.html">
            
                    
                    Traits
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../objects/example.html">
            
                <a href="../objects/example.html">
            
                    
                    Example program
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../functions/">
            
                <a href="../functions/">
            
                    
                    Function advanced
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../pattern/">
            
                <a href="../pattern/">
            
                    
                    Pattern matching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="./">
            
                <a href="./">
            
                    
                    Templates
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="special.html">
            
                <a href="special.html">
            
                    
                    Specialization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="cte.html">
            
                <a href="cte.html">
            
                    
                    Compile time execution
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="values.html">
            
                <a href="values.html">
            
                    
                    Template as values
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.11" data-path="operators.html">
            
                <a href="operators.html">
            
                    
                    Operator overloading
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../errors/main.html">
            
                <a href="../errors/main.html">
            
                    
                    Error handling
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../errors/scope.html">
            
                <a href="../errors/scope.html">
            
                    
                    Scope guards
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../version/README.md">
            
                <span>
            
                    
                    Version
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" >
            
                <span>
            
                    
                    Documentation
            
                </span>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Operator overloading</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-minus-circle"></i><ul><li><span class="title-icon "></span><a href="#operator-overloading"><b>1. </b>Operator overloading</a></li><ul><li><span class="title-icon "></span><a href="#unary-operator"><b>1.1. </b>Unary operator</a></li><li><span class="title-icon "></span><a href="#binary-operator"><b>1.2. </b>Binary operator</a></li><li><span class="title-icon "></span><a href="#comparison-operators"><b>1.3. </b>Comparison operators</a></li><ul><li><span class="title-icon "></span><a href="#overloading--and-"><b>1.3.1. </b>Overloading == and !=</a></li><li><span class="title-icon "></span><a href="#overloading----and-"><b>1.3.2. </b>Overloading <,>, <= and="">=</=></,></a></li></ul><li><span class="title-icon "></span><a href="#assignment"><b>1.4. </b>Assignment</a></li><li><span class="title-icon "></span><a href="#access-operator"><b>1.5. </b>Access operator</a></li><li><span class="title-icon "></span><a href="#contain-operator"><b>1.6. </b>Contain operator</a></li></ul></ul></div><a href="#operator-overloading" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="operator-overloading"><a name="operator-overloading" class="anchor-navigation-ex-anchor" href="#operator-overloading"><i class="fa fa-link" aria-hidden="true"></i></a>1. Operator overloading</h1>
<p>The operator overload is done by rewriting the operations applied on
objects operands. No new syntax is used for operator overloading. They
use compilation time values, and template definition to choose the
correct operator.</p>
<h2 id="unary-operator"><a name="unary-operator" class="anchor-navigation-ex-anchor" href="#unary-operator"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. Unary operator</h2>
<p>The overloading of binary operators is done by defining the <code>opUnary</code> function.
It is rewritten as follows: </p>
<table>
<thead>
<tr>
<th>expression</th>
<th>rewrite</th>
</tr>
</thead>
<tbody>
<tr>
<td>-e</td>
<td>e.opUnary!(&quot;-&quot;)</td>
</tr>
<tr>
<td>*e</td>
<td>e.opUnary!(&quot;*&quot;)</td>
</tr>
<tr>
<td>!e</td>
<td>e.opUnary!(&quot;!&quot;)</td>
</tr>
</tbody>
</table>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> A  <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token punctuation">:</span> <span class="token type">f32</span><span class="token punctuation">;</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">self</span> <span class="token punctuation">(</span>a <span class="token punctuation">:</span> <span class="token type">f32</span><span class="token punctuation">)</span> <span class="token keyword">with</span> a <span class="token operator">=</span> a <span class="token punctuation">{</span><span class="token punctuation">}</span> 

    <span class="token other-keyword">pub</span> <span class="token keyword">def</span> <span class="token function">opUnary</span> <span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> A <span class="token punctuation">{</span>
    <span class="token path">A</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token keyword">self</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">def</span> <span class="token function">opUnary</span> <span class="token punctuation">(</span>op <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token basic-types">c32</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> A <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token string">&quot;!&quot;</span><span class="token punctuation">)</span>
            <span class="token path">A</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">.</span>f <span class="token operator">/</span> <span class="token keyword">self</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
        <span class="token keyword">else</span>
            <span class="token keyword">self</span>
    <span class="token punctuation">}</span>

    impl <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">Printable</span> <span class="token punctuation">{</span>
        <span class="token other-keyword">pub</span> <span class="token keyword">over</span> <span class="token function">print</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">print</span> <span class="token punctuation">(</span><span class="token string">&quot;A(&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>a<span class="token punctuation">,</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token path">A</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">.</span>0f<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println</span> <span class="token punctuation">(</span><span class="token operator">!</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">// This is exactly the same as : </span>
    <span class="token comment">// println (a.opUnary!(&quot;!&quot;) ());</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="binary-operator"><a name="binary-operator" class="anchor-navigation-ex-anchor" href="#binary-operator"><i class="fa fa-link" aria-hidden="true"></i></a>1.2. Binary operator</h2>
<p>Binary operators are also overloadable. As for unary operators, this
overload can only be done on objects. They are rewritten with the
function <code>opBinary</code> and <code>opBinaryRight</code>. The rewritte with a call to
the function <code>opBinary</code> is tested first, and if it does not compile,
then the rewritte with the call to the function <code>opBinaryRight</code> is
then tried.</p>
<p>The following operators are overloadable. The use indicated in the
left column is only an indication and corresponds to the common use of
these operators, but they can of course be used for other purposes.</p>
<table>
<tbody>
<tr>
<td align="left"><bold>Math</bold></td>
<td align="center"><code>+</code></td>
<td align="center"><code>-</code></td>
<td align="center"><code>*</code></td>
<td align="center"><code>/</code></td>
<td align="center"><code>%</code></td>
<td align="center"><code>^^</code></td>
</tr>

<tr>
<td align="left"><bold>Bitwise</bold></td>
<td align="center"><code>|</code></td>
<td align="center"><code>&amp;</code></td>
<td align="center"><code>^</code></td>
<td align="center"><code> &lt;&lt; </code></td>
<td align="center"><code> &gt;&gt; </code></td>
</tr>

<tr>
<td align="left"><bold>Array</bold></td>
<td align="center"><code>~</code></td>
</tr>
</tbody>
</table>

<!-- |     |     |      |      |     |      | -->
<!-- | --- | --- | ---- | --- | --- | ---- | -->
<!-- | `+` |    `-`    | `*`  | `/` |    `%` | `^^` | -->
<!-- | `\|` | `^` | `<<` | `>>` |    `~` | `&`  | -->
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> A <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">;</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">self</span> <span class="token punctuation">(</span>a <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span> <span class="token keyword">with</span> a <span class="token operator">=</span> a <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">def</span> <span class="token function">opBinary</span> <span class="token punctuation">(</span><span class="token string">&quot;+&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> a <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> A <span class="token punctuation">{</span>
        <span class="token path">A</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>a <span class="token operator">+</span> a<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">def</span> <span class="token function">opBinaryRight</span> <span class="token punctuation">(</span><span class="token string">&quot;+&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> a <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span><span class="token punctuation">-&gt;</span> A
        <span class="token keyword">self</span> <span class="token operator">+</span> a

    <span class="token other-keyword">pub</span> <span class="token keyword">def</span> <span class="token function">opBinary</span> <span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> a <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> A <span class="token punctuation">{</span>
        <span class="token path">A</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>a <span class="token operator">-</span> a<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">def</span> <span class="token function">opBinaryRight</span> <span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> a <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span><span class="token punctuation">-&gt;</span> A
        <span class="token path">A</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span>a <span class="token operator">-</span> <span class="token keyword">self</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>


    impl <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">Printable</span> <span class="token punctuation">{</span>
        <span class="token other-keyword">pub</span> <span class="token keyword">over</span> <span class="token function">print</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">print</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token path">A</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println</span> <span class="token punctuation">(</span><span class="token number">30</span> <span class="token operator">-</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="comparison-operators"><a name="comparison-operators" class="anchor-navigation-ex-anchor" href="#comparison-operators"><i class="fa fa-link" aria-hidden="true"></i></a>1.3. Comparison operators</h2>
<p>The comparison operators are also overloadable, but not like binary
operators. The equality and comparison are treated via two different
functions <code>opEquals</code> and <code>opCmp</code>. Because while almost all types can
be compared for equality, only some have meaningful order comparison. </p>
<p>The <code>opCmp</code> function is used for the operators <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code> and <code>&gt;=</code>
only. And the function <code>opEquals</code> is used for the operator <code>==</code> and
<code>!=</code>. When the method <code>opEquals</code> is not defined for the type, the
compiler will try to use the method <code>opCmp</code> instead. When both the
function are defined, it is up to the user to ensure that these two
functions are consistent.</p>
<p>Indeed, it is impossible to verify that in a general case. You may
want for example to define a set object, where the operator <code>x &lt; y</code>
stand for <code>x</code> is a strict subset of <code>y</code>. Therefore, if neither <code>x &lt; y</code>
and <code>y &lt; x</code> are true, that does not implies that <code>x == y</code>.</p>
<h3 id="overloading--and-"><a name="overloading--and-" class="anchor-navigation-ex-anchor" href="#overloading--and-"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.1. Overloading == and !=</h3>
<p>Expression of the form <code>a != b</code>, are rewritten into <code>!(a == b)</code>,
therefore there is only one function to define. </p>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span>

<span class="token keyword">class</span> Point <span class="token punctuation">{</span>

    <span class="token keyword">let</span> x <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">,</span> y <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">;</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">self</span> <span class="token punctuation">(</span>x <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">,</span> y <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span> <span class="token keyword">with</span> x <span class="token operator">=</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> y <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">def</span> <span class="token function">opEquals</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> other <span class="token punctuation">:</span> <span class="token type">Point</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token basic-types">bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>x <span class="token operator">==</span> other<span class="token punctuation">.</span>x <span class="token operator">&amp;&amp;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y <span class="token operator">==</span> other<span class="token punctuation">.</span>y
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> AssertError <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token path">Point</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token path">Point</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token path">Point</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span>a <span class="token operator">!=</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The operator <code>opEquals</code> is supposed commutative, so when the operator
is only defined for the type on the right operand, the operation will
simply be rewritten reversely.</p>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span>

<span class="token keyword">class</span> MyInt <span class="token punctuation">{</span>

    <span class="token keyword">let</span> i <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">;</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">self</span> <span class="token punctuation">(</span>i <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span> <span class="token keyword">with</span> i <span class="token operator">=</span> i <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">def</span> <span class="token function">opEquals</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> i <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token basic-types">bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>i <span class="token operator">==</span> i
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> AssertError <span class="token punctuation">{</span>
    <span class="token keyword">let</span> mi <span class="token operator">=</span> <span class="token path">MyInt</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">==</span> mi<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="overloading----and-"><a name="overloading----and-" class="anchor-navigation-ex-anchor" href="#overloading----and-"><i class="fa fa-link" aria-hidden="true"></i></a>1.3.2. Overloading &lt;, &gt;, &lt;= and &gt;=</h3>
<p>Those operators are overloadable by rewritting and calling the method
<code>opCmp</code>. This method must return an signed integer element. The
following table presents how the operators are rewritten.</p>
<table>
<thead>
<tr>
<th>comparison</th>
<th>rewrite 1</th>
<th>rewrite 2</th>
</tr>
</thead>
<tbody>
<tr>
<td>a &lt; b</td>
<td>a.opCmp (b) &lt; 0</td>
<td>b.opCmp (a) &gt; 0</td>
</tr>
<tr>
<td>a &gt; b</td>
<td>a.opCmp (b) &gt; 0</td>
<td>b.opCmp (a) &lt; 0</td>
</tr>
<tr>
<td>a &lt;= b</td>
<td>a.opCmp (b) &lt;= 0</td>
<td>b.opCmp (a) &gt;= 0</td>
</tr>
<tr>
<td>a &gt;= b</td>
<td>a.opCmp (b) &gt;= 0</td>
<td>b.opCmp (a) &gt;= 0</td>
</tr>
</tbody>
</table>
<p>The first rewrite is tried first, if it fails, the second is tested.
If the method <code>opEquals</code> is not defined the method <code>opCmp</code> will be
used, and will be rewritten as <code>a.opCmp (b) == 0</code>.</p>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span>

<span class="token keyword">class</span> MyInt <span class="token punctuation">{</span>

    <span class="token keyword">let</span> i <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">;</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">self</span> <span class="token punctuation">(</span>i <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span> <span class="token keyword">with</span> i <span class="token operator">=</span> i <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">def</span> <span class="token function">opCmp</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> i <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token basic-types">i32</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>i <span class="token operator">-</span> i
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> AssertError <span class="token punctuation">{</span>
    <span class="token keyword">let</span> mi <span class="token operator">=</span> <span class="token path">MyInt</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span><span class="token number">7</span> <span class="token operator">&lt;</span> mi<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="assignment"><a name="assignment" class="anchor-navigation-ex-anchor" href="#assignment"><i class="fa fa-link" aria-hidden="true"></i></a>1.4. Assignment</h2>
<p>The assignment operator is not overloadable, it will always perform
the same operation. However, the shortcut operators <code>+=</code>, <code>-=</code>, <code>*=</code>
etc, are usable on object when oveloading the binary operator. In that
case, the method <code>opBinary</code> must return a mutable object.</p>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span>

<span class="token keyword">class</span> MyInt <span class="token punctuation">{</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">let</span> i <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">;</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">self</span> <span class="token punctuation">(</span>i <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span> <span class="token keyword">with</span> i <span class="token operator">=</span> i <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">def</span> <span class="token function">opBinary</span> <span class="token punctuation">(</span><span class="token string">&quot;+&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> a <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span><span class="token punctuation">-&gt;</span> <span class="token other-keyword">mut</span> MyInt <span class="token punctuation">{</span>
        <span class="token comment">//                                   ^^^</span>
        <span class="token comment">//                     Try to remove the mut there</span>
        <span class="token path">MyInt</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>i <span class="token operator">+</span> a<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token other-keyword">mut</span> mi <span class="token operator">=</span> <span class="token path">MyInt</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mi <span class="token operator">+=</span> <span class="token number">9</span><span class="token punctuation">;</span>
    <span class="token function">println</span> <span class="token punctuation">(</span>mi<span class="token punctuation">.</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="access-operator"><a name="access-operator" class="anchor-navigation-ex-anchor" href="#access-operator"><i class="fa fa-link" aria-hidden="true"></i></a>1.5. Access operator</h2>
<p>The operator of index <code>[]</code> is overloadable by the method
<code>opIndex</code>. This method will simply be called with the parameters
passed inside of the brackets. For example, the following operation <code>a
[b, c, d]</code> will be rewrite into <code>a.opIndex (b, c, d)</code>.</p>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span>

<span class="token keyword">class</span> A <span class="token punctuation">{</span>
    <span class="token keyword">let</span> i <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token basic-types">i32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">self</span> <span class="token punctuation">(</span>a <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token basic-types">i32</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">with</span> i <span class="token operator">=</span> a <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">def</span> <span class="token function">opIndex</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> x <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token basic-types">i32</span> 
        <span class="token keyword">throws</span> OutOfArray
    <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>i <span class="token punctuation">[</span>x<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">throws</span> OutOfArray<span class="token punctuation">,</span> AssertError
<span class="token punctuation">{</span>
    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token path">A</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span>i <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="contain-operator"><a name="contain-operator" class="anchor-navigation-ex-anchor" href="#contain-operator"><i class="fa fa-link" aria-hidden="true"></i></a>1.6. Contain operator</h2>
<p>The contain operator is a binary operator used to check if an element
is inside another one. This operator is defined using the keyword
<code>in</code>. Unlike other operator, the rewritte for the overloading is made
only once on the right operand, and call the method <code>opContains</code>. The
expression <code>a !in b</code> will be rewritten into <code>!(a in b)</code>.</p>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">class</span> A <span class="token punctuation">{</span>

    <span class="token keyword">let</span> a <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token basic-types">i32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">self</span> <span class="token punctuation">(</span>a <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token basic-types">i32</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">with</span> a <span class="token operator">=</span> a <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">def</span> <span class="token function">opContains</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> i <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span><span class="token punctuation">-&gt;</span> <span class="token basic-types">bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token keyword">self</span><span class="token punctuation">.</span>a <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> j<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token other-keyword">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token other-keyword">false</span>
    <span class="token punctuation">}</span>    
<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">throws</span> AssertError
<span class="token punctuation">{</span>
    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token path">A</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token keyword">in</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span><span class="token number">9</span> <span class="token operator">!</span><span class="token keyword">in</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="values.html" class="navigation navigation-prev " aria-label="Previous page: Template as values">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../errors/main.html" class="navigation navigation-next " aria-label="Next page: Error handling">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Operator overloading","level":"1.11","depth":1,"next":{"title":"Error handling","level":"1.12","depth":1,"path":"errors/main.md","ref":"errors/main.md","articles":[{"title":"Scope guards","level":"1.12.1","depth":2,"path":"errors/scope.md","ref":"errors/scope.md","articles":[]}]},"previous":{"title":"Template as values","level":"1.10.3","depth":2,"path":"templates/values.md","ref":"templates/values.md","articles":[]},"dir":"ltr"},"config":{"plugins":["prism","-highlight","katex","codeblock-filename","spoiler","folding-menu","language-picker","anchor-nav-x","code"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{"css":["themes/code.css"]},"spoiler":{},"language-picker":{"grid-columns":3},"search":{},"folding-menu":{"animationDuration":400,"sticky":false},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code":{"copyButtons":true},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"anchor-navigation-ex":{"isRewritePageTitle":false},"codeblock-filename":{},"anchor-nav-x":{"associatedWithSummary":true,"float":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showLevel":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"en","gitbook":"*"},"file":{"path":"templates/operators.md","mtime":"2021-02-21T18:58:12.637Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-03-20T14:51:48.049Z"},"basePath":"..","book":{"language":"en"}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-spoiler/spoiler.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-folding-menu/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-language-picker/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-anchor-nav-x/lib/handler.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

