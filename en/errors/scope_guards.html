
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Scope guards Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/code.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-codeblock-filename/block.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-spoiler/spoiler.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-language-picker/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchor-nav-x/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="catching.html" />
    
    
    <link rel="prev" href="main.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../hello-world/">
            
                <a href="../hello-world/">
            
                    
                    Hello World
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../hello-world/commentaires.html">
            
                <a href="../hello-world/commentaires.html">
            
                    
                    Comments
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../primitives/">
            
                <a href="../primitives/">
            
                    
                    Basic programming concepts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../primitives/variables.html">
            
                <a href="../primitives/variables.html">
            
                    
                    Variable and Mutability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../primitives/types.html">
            
                <a href="../primitives/types.html">
            
                    
                    Data types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../primitives/functions.html">
            
                <a href="../primitives/functions.html">
            
                    
                    Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../primitives/control.html">
            
                <a href="../primitives/control.html">
            
                    
                    Control flows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../primitives/operator.html">
            
                <a href="../primitives/operator.html">
            
                    
                    Operator priority
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../advanced/">
            
                <a href="../advanced/">
            
                    
                    Alias and References
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../advanced/references.html">
            
                <a href="../advanced/references.html">
            
                    
                    References
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../advanced/alias.html">
            
                <a href="../advanced/alias.html">
            
                    
                    Aliases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../advanced/copies.html">
            
                <a href="../advanced/copies.html">
            
                    
                    Copy and Deep copy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../advanced/best.html">
            
                <a href="../advanced/best.html">
            
                    
                    Best practice
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../modules/">
            
                <a href="../modules/">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../types/">
            
                <a href="../types/">
            
                    
                    User defined types
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../types/struct.html">
            
                <a href="../types/struct.html">
            
                    
                    Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../types/enum.html">
            
                <a href="../types/enum.html">
            
                    
                    Enum
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../types/aka.html">
            
                <a href="../types/aka.html">
            
                    
                    Aka
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../objects/">
            
                <a href="../objects/">
            
                    
                    Objects
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../objects/class.html">
            
                <a href="../objects/class.html">
            
                    
                    Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../objects/mutability.html">
            
                <a href="../objects/mutability.html">
            
                    
                    Mutability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../objects/methods.html">
            
                <a href="../objects/methods.html">
            
                    
                    Methods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../objects/inheritance.html">
            
                <a href="../objects/inheritance.html">
            
                    
                    Inheritance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../objects/traits.html">
            
                <a href="../objects/traits.html">
            
                    
                    Traits
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../objects/cast.html">
            
                <a href="../objects/cast.html">
            
                    
                    Cast, and dynamic typing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../functions/">
            
                <a href="../functions/">
            
                    
                    Function advanced
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../pattern/">
            
                <a href="../pattern/">
            
                    
                    Pattern matching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="main.html">
            
                <a href="main.html">
            
                    
                    Error handling
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.10.1" data-path="scope_guards.html">
            
                <a href="scope_guards.html">
            
                    
                    Scope guards
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="catching.html">
            
                <a href="catching.html">
            
                    
                    Catching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="option.html">
            
                <a href="option.html">
            
                    
                    Exception and option type
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="fptr_closure.html">
            
                <a href="fptr_closure.html">
            
                    
                    Unsafe function pointer
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../templates/">
            
                <a href="../templates/">
            
                    
                    Templates
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../templates/special.html">
            
                <a href="../templates/special.html">
            
                    
                    Template types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../templates/cte.html">
            
                <a href="../templates/cte.html">
            
                    
                    Template values
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../templates/values.html">
            
                <a href="../templates/values.html">
            
                    
                    Compilation time execution
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../objects/common_traits.html">
            
                <a href="../objects/common_traits.html">
            
                    
                    Common traits
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../traits/streamable.html">
            
                <a href="../traits/streamable.html">
            
                    
                    Streamable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../traits/copiable.html">
            
                <a href="../traits/copiable.html">
            
                    
                    Copiable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../traits/disposable.html">
            
                <a href="../traits/disposable.html">
            
                    
                    With guard and Disposable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="../traits/hashable.html">
            
                <a href="../traits/hashable.html">
            
                    
                    Hashable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="../traits/serialize.html">
            
                <a href="../traits/serialize.html">
            
                    
                    Packable and Serializable
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../templates/operators.html">
            
                <a href="../templates/operators.html">
            
                    
                    Operator overloading
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../version/README.md">
            
                <span>
            
                    
                    Version
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" >
            
                <span>
            
                    
                    Documentation
            
                </span>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Scope guards</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-minus-circle"></i><ul><li><span class="title-icon "></span><a href="#scope-guards"><b>1. </b>Scope guards</a></li><ul><li><span class="title-icon "></span><a href="#success-guard"><b>1.1. </b>Success guard</a></li><li><span class="title-icon "></span><a href="#failure-guard"><b>1.2. </b>Failure guard</a></li><li><span class="title-icon "></span><a href="#exit-guard"><b>1.3. </b>Exit guard</a></li><li><span class="title-icon "></span><a href="#scope-guard-priority"><b>1.4. </b>Scope guard priority</a></li></ul></ul></div><a href="#scope-guards" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="scope-guards"><a name="scope-guards" class="anchor-navigation-ex-anchor" href="#scope-guards"><i class="fa fa-link" aria-hidden="true"></i></a>1. Scope guards</h1>
<p>Scope guards are expressions attached to a scope (block of code), that
are executed on specific cases in the scope that is guarded. There are
four different scope guards, <strong><code>exit</code></strong>, <strong><code>failure</code></strong>, <strong><code>success</code></strong>
and <strong><code>catch</code></strong>. This chapter does not discuss the <em>catch</em> scope
guard, that will be discussed in the next chapter.</p>
<p>The syntax of <em>exit</em>, <em>success</em> and <em>failure</em> scope guards is the following: </p>
<pre class="language-"><code class="lang-grammar"><span class="token path">guarded_scope</span> <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">&apos;{&apos;</span> expression <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&apos;;&apos;</span><span class="token punctuation">)</span>? expression<span class="token punctuation">)</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token string">&apos;;&apos;</span><span class="token punctuation">)</span>? <span class="token string">&apos;}&apos;</span> guards
<span class="token path">guards</span> <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token punctuation">(</span>Guard expression<span class="token punctuation">)</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token string">&apos;catch&apos;</span> catching_expression<span class="token punctuation">)</span>? <span class="token punctuation">(</span>Guard expression<span class="token punctuation">)</span><span class="token operator">*</span>
<span class="token path">Guard</span> <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token string">&apos;exit&apos;</span> <span class="token operator">|</span> <span class="token string">&apos;success&apos;</span> <span class="token operator">|</span> <span class="token string">&apos;failure&apos;</span>
</code></pre>
<h2 id="success-guard"><a name="success-guard" class="anchor-navigation-ex-anchor" href="#success-guard"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. Success guard</h2>
<p>Scope guards are associate with expressions, that are executed when a
specific events occurs in the scope that is guarded. In the case of
<em>success</em> scope guard, the event that triggers the guard expression,
is when no error occured (nothing was thrown in the scope). </p>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span><span class="token punctuation">;</span>

<span class="token keyword">def</span> <span class="token function">foo</span> <span class="token punctuation">(</span>i <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span>
    <span class="token keyword">throws</span> <span class="token operator">&amp;</span><span class="token type">AssertError</span>
<span class="token punctuation">{</span>
    <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;I : &quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;i must be lower than 10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> success <span class="token punctuation">{</span>
    <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;Nothing was thrown !!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">throws</span> <span class="token operator">&amp;</span><span class="token type">AssertError</span>
<span class="token punctuation">{</span>
    <span class="token function">foo</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">foo</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><br>
Results: </p>
<pre class="language-"><code>I : 1
Nothing was thrown !!
I : 20
Unhandled exception
Exception in file &quot;/home/emile/ymir/Runtime/midgard/core/exception.yr&quot;, at line 84, in function &quot;core::exception::abort&quot;, of type core::exception::AssertError.
&#x256D;  Stack trace :
&#x255E;&#x2550; bt &#x2555; #1
&#x2502;     &#x2558;&#x2550;&gt; /lib/libgyruntime.so:??
&#x255E;&#x2550; bt &#x2555; #2
&#x2502;     &#x2558;&#x2550;&gt; /lib/libgyruntime.so:??
&#x255E;&#x2550; bt &#x2555; #3 in function core::exception::abort (...)
&#x2502;     &#x2558;&#x2550;&gt; /home/emile/ymir/Runtime/midgard/core/exception.yr:84
&#x255E;&#x2550; bt &#x2555; #4 in function main::foo (...)
&#x2502;     &#x2558;&#x2550;&gt; /home/emile/Documents/test/ymir/main.yr:8
&#x255E;&#x2550; bt &#x2555; #5 in function main (...)
&#x2502;     &#x2558;&#x2550;&gt; /home/emile/Documents/test/ymir/main.yr:12
&#x255E;&#x2550; bt &#x2555; #6
&#x2502;     &#x2558;&#x2550;&gt; /lib/libgyruntime.so:??
&#x255E;&#x2550; bt &#x2555; #7 in function main
&#x2502;     &#x2558;&#x2550;&gt; /home/emile/Documents/test/ymir/main.yr:12
&#x255E;&#x2550; bt &#x2555; #8
&#x2502;     &#x2558;&#x2550;&gt; /lib/x86_64-linux-gnu/libc.so.6:??
&#x255E;&#x2550; bt &#x2550; #9 in function _start
&#x2570;
Aborted (core dumped)
</code></pre><p><br></p>
<p>This scope guard can be used on scope that never throw exceptions, in
that case it is always executed. This goal of this scope guard is to
execute operation at the end of a scope, only when the operation
succeded (e.g. writting logs, sending acknolegement, etc.). It can be
coupled with other scope guards, to perform different operation when
the scope didn&apos;t succeded.</p>
<h2 id="failure-guard"><a name="failure-guard" class="anchor-navigation-ex-anchor" href="#failure-guard"><i class="fa fa-link" aria-hidden="true"></i></a>1.2. Failure guard</h2>
<p>The <em>failure</em> scope guard does the opposite of the <em>success</em> scope
guard, meaning that the associated expression is only executed when an
exception was thrown in the scope that is guarded. This scope guard is
really useful to perform operation without recovering from the
error. Indeed, the <em>failure</em> guard is not a <em>catch</em> guard, and the
execption that is thrown in the guarded scope continue its journey,
but the expression in the scope guard are guaranteed to be executed
(e.g. logging the error, closing a socket, unlocking a mutex, etc.).</p>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span><span class="token punctuation">;</span>

<span class="token keyword">def</span> <span class="token function">foo</span> <span class="token punctuation">(</span>i <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span>
    <span class="token keyword">throws</span> <span class="token operator">&amp;</span><span class="token type">AssertError</span>
<span class="token punctuation">{</span>
    <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;I : &quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;i must be lower than 10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> failure <span class="token punctuation">{</span>
    <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;Well there was an error...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">throws</span> <span class="token operator">&amp;</span><span class="token type">AssertError</span>
<span class="token punctuation">{</span>
    <span class="token function">foo</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">foo</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><br>
Results:</p>
<pre class="language-"><code>I : 1
I : 20
Well there was an error...
Unhandled exception
Exception in file &quot;/home/emile/ymir/Runtime/midgard/core/exception.yr&quot;, at line 84, in function &quot;core::exception::abort&quot;, of type core::exception::AssertError.
&#x256D;  Stack trace :
&#x255E;&#x2550; bt &#x2555; #1
&#x2502;     &#x2558;&#x2550;&gt; /lib/libgyruntime.so:??
&#x255E;&#x2550; bt &#x2555; #2
&#x2502;     &#x2558;&#x2550;&gt; /lib/libgyruntime.so:??
&#x255E;&#x2550; bt &#x2555; #3
&#x2502;     &#x2558;&#x2550;&gt; /lib/libgyruntime.so:??
&#x255E;&#x2550; bt &#x2555; #4 in function main::foo (...)
&#x2502;     &#x2558;&#x2550;&gt; /home/emile/Documents/test/ymir/main.yr:8
&#x255E;&#x2550; bt &#x2555; #5 in function main (...)
&#x2502;     &#x2558;&#x2550;&gt; /home/emile/Documents/test/ymir/main.yr:12
&#x255E;&#x2550; bt &#x2555; #6
&#x2502;     &#x2558;&#x2550;&gt; /lib/libgyruntime.so:??
&#x255E;&#x2550; bt &#x2555; #7 in function main
&#x2502;     &#x2558;&#x2550;&gt; /home/emile/Documents/test/ymir/main.yr:12
&#x255E;&#x2550; bt &#x2555; #8
&#x2502;     &#x2558;&#x2550;&gt; /lib/x86_64-linux-gnu/libc.so.6:??
&#x255E;&#x2550; bt &#x2550; #9 in function _start
&#x2570;
Aborted (core dumped)
</code></pre><h2 id="exit-guard"><a name="exit-guard" class="anchor-navigation-ex-anchor" href="#exit-guard"><i class="fa fa-link" aria-hidden="true"></i></a>1.3. Exit guard</h2>
<p>The <em>exit</em> scope guard is the combination of the <em>success</em> and
<em>failure</em> guards. The operation contained in the guards are always
executed, no matter what happened in the scope that is guarded. It can
be seen as a shortcut for the <em>success</em> and <em>failure</em> guards doing the
same operations, but avoiding code repetition.</p>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span><span class="token punctuation">;</span>

<span class="token keyword">def</span> <span class="token function">foo</span> <span class="token punctuation">(</span>i <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span>
    <span class="token keyword">throws</span> <span class="token operator">&amp;</span><span class="token type">AssertError</span>
<span class="token punctuation">{</span>
    <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;I : &quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assert</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;i must be lower than 10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> exit <span class="token punctuation">{</span>
    <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;The scope is exited, with an error or not, who knows&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">throws</span> <span class="token operator">&amp;</span><span class="token type">AssertError</span>
<span class="token punctuation">{</span>
    <span class="token function">foo</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">foo</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><br></p>
<p>Results:</p>
<pre class="language-"><code>I : 1
The scope is exited, with an error or not, who knows
I : 20
The scope is exited, with an error or not, who knows
Unhandled exception
Exception in file &quot;/home/emile/ymir/Runtime/midgard/core/exception.yr&quot;, at line 84, in function &quot;core::exception::abort&quot;, of type core::exception::AssertError.
&#x256D;  Stack trace :
&#x255E;&#x2550; bt &#x2555; #1
&#x2502;     &#x2558;&#x2550;&gt; /lib/libgyruntime.so:??
&#x255E;&#x2550; bt &#x2555; #2
&#x2502;     &#x2558;&#x2550;&gt; /lib/libgyruntime.so:??
&#x255E;&#x2550; bt &#x2555; #3
&#x2502;     &#x2558;&#x2550;&gt; /lib/libgyruntime.so:??
&#x255E;&#x2550; bt &#x2555; #4 in function main::foo (...)
&#x2502;     &#x2558;&#x2550;&gt; /home/emile/Documents/test/ymir/main.yr:8
&#x255E;&#x2550; bt &#x2555; #5 in function main (...)
&#x2502;     &#x2558;&#x2550;&gt; /home/emile/Documents/test/ymir/main.yr:12
&#x255E;&#x2550; bt &#x2555; #6
&#x2502;     &#x2558;&#x2550;&gt; /lib/libgyruntime.so:??
&#x255E;&#x2550; bt &#x2555; #7 in function main
&#x2502;     &#x2558;&#x2550;&gt; /home/emile/Documents/test/ymir/main.yr:12
&#x255E;&#x2550; bt &#x2555; #8
&#x2502;     &#x2558;&#x2550;&gt; /lib/x86_64-linux-gnu/libc.so.6:??
&#x255E;&#x2550; bt &#x2550; #9 in function _start
&#x2570;
Aborted (core dumped)
</code></pre><h2 id="scope-guard-priority"><a name="scope-guard-priority" class="anchor-navigation-ex-anchor" href="#scope-guard-priority"><i class="fa fa-link" aria-hidden="true"></i></a>1.4. Scope guard priority</h2>
<p>It is possible to use multiple scope guards for the same scope. In
that case, the order of execution of the scopes is the following :</p>
<ul>
<li>1) for the scope guards of same nature (e.g. two <em>failure</em> guards),
the execution is done is the order they are written.</li>
</ul>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span><span class="token punctuation">;</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token punctuation">{</span>
        <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;Scope operation&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> exit <span class="token punctuation">{</span>
        <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;Exit 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> exit <span class="token punctuation">{</span>
        <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;Exit 2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><br>
Results: </p>
<pre class="language-"><code>Scope operation
Exit 1
Exit 2
</code></pre><p><br></p>
<ul>
<li>2) If there is an <em>exit</em> guard and a <em>success</em> or a <em>failure</em> guard,
then the <em>success</em> and <em>failure</em> guards are executed first.</li>
</ul>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span><span class="token punctuation">;</span>

<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token punctuation">{</span>
        <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;Scope operation&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> success <span class="token punctuation">{</span>
        <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;Success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> exit <span class="token punctuation">{</span>
        <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;Exit 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> exit <span class="token punctuation">{</span>
        <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;Exit 2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> success <span class="token punctuation">{</span>
        <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;Success 2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre>
<p><br>
Results: </p>
<pre class="language-"><code>Scope operation
Success
Success 2
Exit 1
Exit 2
</code></pre><p><br></p>
<ul>
<li>3) The priority between <em>failure</em> and <em>success</em> is not defined, they
simply cannot happen at the same time.</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="main.html" class="navigation navigation-prev " aria-label="Previous page: Error handling">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="catching.html" class="navigation navigation-next " aria-label="Next page: Catching">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Scope guards","level":"1.10.1","depth":2,"next":{"title":"Catching","level":"1.10.2","depth":2,"path":"errors/catching.md","ref":"errors/catching.md","articles":[]},"previous":{"title":"Error handling","level":"1.10","depth":1,"path":"errors/main.md","ref":"errors/main.md","articles":[{"title":"Scope guards","level":"1.10.1","depth":2,"path":"errors/scope_guards.md","ref":"errors/scope_guards.md","articles":[]},{"title":"Catching","level":"1.10.2","depth":2,"path":"errors/catching.md","ref":"errors/catching.md","articles":[]},{"title":"Exception and option type","level":"1.10.3","depth":2,"path":"errors/option.md","ref":"errors/option.md","articles":[]},{"title":"Unsafe function pointer","level":"1.10.4","depth":2,"path":"errors/fptr_closure.md","ref":"errors/fptr_closure.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["prism","-highlight","katex","codeblock-filename","spoiler","folding-menu","language-picker","anchor-nav-x","code"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{"css":["themes/code.css"]},"spoiler":{},"language-picker":{"grid-columns":3},"search":{},"folding-menu":{"animationDuration":400,"sticky":false},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code":{"copyButtons":true},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"anchor-navigation-ex":{"isRewritePageTitle":false,"toolTipMode":"click"},"codeblock-filename":{},"anchor-nav-x":{"associatedWithSummary":true,"float":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showLevel":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"en","gitbook":"*"},"file":{"path":"errors/scope_guards.md","mtime":"2021-06-17T05:03:47.360Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-06-17T06:30:34.719Z"},"basePath":"..","book":{"language":"en"}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-spoiler/spoiler.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-folding-menu/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-language-picker/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-anchor-nav-x/lib/handler.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

