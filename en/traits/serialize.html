
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Packable and Serializable Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/code.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-codeblock-filename/block.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-spoiler/spoiler.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-language-picker/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchor-nav-x/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../templates/operators.html" />
    
    
    <link rel="prev" href="hashable.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../hello-world/">
            
                <a href="../hello-world/">
            
                    
                    Hello World
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../hello-world/commentaires.html">
            
                <a href="../hello-world/commentaires.html">
            
                    
                    Comments
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../primitives/">
            
                <a href="../primitives/">
            
                    
                    Basic programming concepts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../primitives/variables.html">
            
                <a href="../primitives/variables.html">
            
                    
                    Variable and Mutability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../primitives/types.html">
            
                <a href="../primitives/types.html">
            
                    
                    Data types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../primitives/functions.html">
            
                <a href="../primitives/functions.html">
            
                    
                    Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../primitives/control.html">
            
                <a href="../primitives/control.html">
            
                    
                    Control flows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../primitives/operator.html">
            
                <a href="../primitives/operator.html">
            
                    
                    Operator priority
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../advanced/">
            
                <a href="../advanced/">
            
                    
                    Alias and References
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../advanced/references.html">
            
                <a href="../advanced/references.html">
            
                    
                    References
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../advanced/alias.html">
            
                <a href="../advanced/alias.html">
            
                    
                    Aliases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../advanced/copies.html">
            
                <a href="../advanced/copies.html">
            
                    
                    Copy and Deep copy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../advanced/best.html">
            
                <a href="../advanced/best.html">
            
                    
                    Best practice
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../modules/">
            
                <a href="../modules/">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../types/">
            
                <a href="../types/">
            
                    
                    User defined types
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../types/struct.html">
            
                <a href="../types/struct.html">
            
                    
                    Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../types/enum.html">
            
                <a href="../types/enum.html">
            
                    
                    Enum
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../types/aka.html">
            
                <a href="../types/aka.html">
            
                    
                    Aka
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../objects/">
            
                <a href="../objects/">
            
                    
                    Objects
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../objects/class.html">
            
                <a href="../objects/class.html">
            
                    
                    Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../objects/mutability.html">
            
                <a href="../objects/mutability.html">
            
                    
                    Mutability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../objects/methods.html">
            
                <a href="../objects/methods.html">
            
                    
                    Methods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../objects/inheritance.html">
            
                <a href="../objects/inheritance.html">
            
                    
                    Inheritance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../objects/traits.html">
            
                <a href="../objects/traits.html">
            
                    
                    Traits
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../objects/cast.html">
            
                <a href="../objects/cast.html">
            
                    
                    Cast, and dynamic typing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../functions/">
            
                <a href="../functions/">
            
                    
                    Function advanced
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../pattern/">
            
                <a href="../pattern/">
            
                    
                    Pattern matching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../errors/main.html">
            
                <a href="../errors/main.html">
            
                    
                    Error handling
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../errors/scope_guards.html">
            
                <a href="../errors/scope_guards.html">
            
                    
                    Scope guards
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../errors/catching.html">
            
                <a href="../errors/catching.html">
            
                    
                    Catching
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../errors/option.html">
            
                <a href="../errors/option.html">
            
                    
                    Exception and option type
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="../errors/fptr_closure.html">
            
                <a href="../errors/fptr_closure.html">
            
                    
                    Unsafe function pointer
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../templates/">
            
                <a href="../templates/">
            
                    
                    Templates
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../templates/special.html">
            
                <a href="../templates/special.html">
            
                    
                    Template types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../templates/cte.html">
            
                <a href="../templates/cte.html">
            
                    
                    Template values
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../templates/values.html">
            
                <a href="../templates/values.html">
            
                    
                    Compilation time execution
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../objects/common_traits.html">
            
                <a href="../objects/common_traits.html">
            
                    
                    Common traits
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="streamable.html">
            
                <a href="streamable.html">
            
                    
                    Streamable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="copiable.html">
            
                <a href="copiable.html">
            
                    
                    Copiable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="disposable.html">
            
                <a href="disposable.html">
            
                    
                    With guard and Disposable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="hashable.html">
            
                <a href="hashable.html">
            
                    
                    Hashable
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.12.5" data-path="serialize.html">
            
                <a href="serialize.html">
            
                    
                    Packable and Serializable
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../templates/operators.html">
            
                <a href="../templates/operators.html">
            
                    
                    Operator overloading
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../templates/binary.html">
            
                <a href="../templates/binary.html">
            
                    
                    Unary, binary and Comparison
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="../templates/complex_operators.html">
            
                <a href="../templates/complex_operators.html">
            
                    
                    Access, contains and iteration
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../version/">
            
                <a href="../version/">
            
                    
                    Version
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../macros/">
            
                <a href="../macros/">
            
                    
                    Macro
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../macros/std.html">
            
                <a href="../macros/std.html">
            
                    
                    Std and Core macros
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../documentation/">
            
                <a href="../documentation/">
            
                    
                    Documentation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../documentation/types.html">
            
                <a href="../documentation/types.html">
            
                    
                    Types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="../documentation/symbols.html">
            
                <a href="../documentation/symbols.html">
            
                    
                    Symbols
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Packable and Serializable</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-minus-circle"></i><ul><li><span class="title-icon "></span><a href="#packable"><b>1. </b>Packable</a></li><ul><li><span class="title-icon "></span><a href="#serializable"><b>1.1. </b>Serializable</a></li></ul></ul></div><a href="#packable" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="packable"><a name="packable" class="anchor-navigation-ex-anchor" href="#packable"><i class="fa fa-link" aria-hidden="true"></i></a>1. Packable</h1>
<p><em>Packable</em> trait (importable from <strong><code>std::net::packet</code></strong>) defines two
methods <strong><code>pack</code></strong> and <strong><code>unpack</code></strong>. There is a default behavior for
those two methods, and it is recommended to not override them, unless
you know exactly what you are doing. The <strong><code>pack</code></strong> method takes a
immutable object instance as parameter and creates a packet of
<strong><code>[u8]</code></strong>, encoding the object. This packet can then be sent throw
network, and unpack from another processes.</p>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">net</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">packet</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> Foo <span class="token punctuation">{</span>
    <span class="token keyword">let</span> _v <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token basic-types">c8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">self</span> <span class="token punctuation">(</span>v <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token basic-types">c8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">with</span> _v <span class="token operator">=</span> v <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token other-keyword">impl</span> Packable<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token path">Foo</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token string">&quot;Test&quot;</span>s8<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> packet <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">pack</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println</span> <span class="token punctuation">(</span>packet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><br>
Results : </p>
<pre class="language-"><code>[9, 0, 0, 0, 0, 0, 0, 0, 34, 6d, 61, 69, 6e, 33, 46, 6f, 6f, 4, 0, 0, 0, 0, 0, 0, 0, 54, 65, 73, 74]
</code></pre><p><br></p>
<p>The packet can then be unpacked with the function <strong><code>unpack</code></strong>. This
function returns an <strong><code>Object</code></strong>, that can be transformed in the
appropriate type using pattern matching.</p>
<pre class="language-"><code class="lang-ymir">    <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token function">unpack</span> <span class="token punctuation">(</span>packet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            x <span class="token punctuation">:</span> <span class="token type">&amp;Foo</span>  <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">println</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            _ <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;Unkown packet&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> catch <span class="token punctuation">{</span>
        <span class="token function">UnpackError</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">println</span> <span class="token punctuation">(</span><span class="token string">&quot;The packet contains unknwon information&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<p><br></p>
<p>Results: </p>
<pre class="language-"><code>main::Foo(Test)
</code></pre><p><br></p>
<p><strong>Warning</strong> to work properly, the unpacker must have access to the
type information of the object that is packed. Otherwise, an
<em>UnpackError</em> is thrown. To make the symbol available in the unpacking
program, the class must be compiled and linked in it. For example, if
a module <strong><code>foo</code></strong> contains a class <strong><code>Foo</code></strong>, and the unpacking is
made inside the **<code>main</code> module. The command line of the compilation
must be : </p>
<pre class="language-"><code class="lang-bash">gyc main.yr foo.yr
</code></pre>
<p><br></p>
<p>It is possible to verify that the symbol are present in the
executable, by running the following command (example for the class
<strong><code>Foo</code></strong> of the previous example).</p>
<pre class="language-"><code class="lang-bash">$ objdump -t a.out <span class="token operator">|</span> <span class="token function">grep</span> Foo
0000000000410585 g     F .text    00000000000004a0              _Y3std3net6packet8Packable27__stdnetwork__unpackContentFxP9x3foo3FooSu8Zusize
0000000000447300  w    O .data    0000000000000030              _Y3foo3FooTI
0000000000410a25 g     F .text    000000000000006e              _Y3std3net6packet8Packable25__stdnetwork__packContentFP83foo3FooxP32x3std10collection3vec6VecNu83VecZv
000000000040eb82 g     F .text    0000000000000054              _Y3foo3Foo4selfFxP9x3foo3FooSc8ZxP9x3foo3Foo
00000000004472f0  w    O .data    0000000000000010              _Y133foo3Foo_nameCSTxSc32
0000000000447340  w    O .data    0000000000000030              _Y3foo3FooVT
000000000040f468 g     F .text    0000000000000093              _Y3std3net6packet8Packable4packFP83foo3FooxP32x3std10collection3vec6VecNu83VecZv
000000000040f381 g     F .text    00000000000000e7              _Y3std3net6packet8Packable4packFP83foo3FooZSu8
00000000004472c0  w    O .data    0000000000000024              _Y183foo3Foo_nameInnerCSTxA9c32
</code></pre>
<p><br></p>
<p>In the result of this command, the symbol <strong><code>_Y3foo3FooTI</code></strong> is
present, this is the symbol containing the type info of the
<strong><code>foo::Foo</code></strong> class, <strong><code>_Y3foo3FooVT</code></strong> contains the vtable, and
<strong><code>_Y3std3net6packet8Packable27__stdnetwork__unpackContentFxP9x3foo3FooSu8Zusize</code></strong>
the function called to unpack the object. These are the three
mandatory symbols to successfully unpack a object (the other symbols
are necessarily there if the vtable is present).</p>
<p>I think this is not a strong problem, as it can be easily resolved;
but must be taken into account when compiling the program.</p>
<p><strong>Contribution</strong>: Almost every types are packable. I think the only
two types that are not are function pointer and closure. I see how
function pointer packing can be done, and it is not difficult and will
be done in future version of the std. On the other hand, because the
type info of the closure is not accessible, i don&apos;t see any way of
packing this type. In any case, closure behavior can be easily
simulated by using a object instance, or a structure and a function
pointer. And trying to pack a not packable type creates compile time
errors, so there is no bad surprise at runtime.</p>
<h2 id="serializable"><a name="serializable" class="anchor-navigation-ex-anchor" href="#serializable"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. Serializable</h2>
<p>Like <em>Packable</em> trait, <em>Serializable</em> is a trait that transform an
object instance into something that can be stored, or sent. However,
unlike <em>Packable</em>, the result is humanely readable, and can be used to
create configuration files for example (current std implements
<strong>toml</strong> and <strong>json</strong> serialization). <em>Serializable</em> objects
implements the method <strong><code>serialize</code></strong>. It has no default behavior
(<strong>Contribution</strong> it is however probably possible to create a default
behavior based on the name of the fields). This method takes an
immutable object instance, and return a <strong><code>&amp;Config</code></strong> value.</p>
<pre class="language-"><code class="lang-ymir"><span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">io</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">config</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">conv</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">config</span><span class="token punctuation">,</span> <span class="token path">std</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">config</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">toml</span><span class="token punctuation">;</span>


<span class="token keyword">struct</span>
<span class="token operator">|</span> A <span class="token punctuation">:</span> <span class="token type">&amp;Foo</span>
<span class="token operator">|</span> B <span class="token punctuation">:</span> <span class="token type">&amp;Foo</span>
 <span class="token punctuation">-&gt;</span> Bar<span class="token punctuation">;</span>

<span class="token keyword">class</span> Foo <span class="token punctuation">{</span>
    <span class="token keyword">let</span> _v <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token basic-types">c32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> _u <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">;</span>

    <span class="token other-keyword">pub</span> <span class="token keyword">self</span> <span class="token punctuation">(</span>v <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token basic-types">c32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> u <span class="token punctuation">:</span> <span class="token basic-types">i32</span><span class="token punctuation">)</span> <span class="token keyword">with</span> _v <span class="token operator">=</span> v<span class="token punctuation">,</span> _u <span class="token operator">=</span> u<span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token other-keyword">impl</span> Serializable <span class="token punctuation">{</span>
        <span class="token other-keyword">pub</span> <span class="token keyword">over</span> <span class="token function">serialize</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">-&gt;</span>  <span class="token operator">&amp;</span><span class="token type">Config</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> <span class="token other-keyword">dmut</span> d <span class="token operator">=</span> <span class="token path">Dict</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            d<span class="token punctuation">:</span><span class="token punctuation">.</span><span class="token function">insert</span> <span class="token punctuation">(</span><span class="token string">&quot;v&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>_v<span class="token punctuation">.</span><span class="token function">to!</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Config<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            d<span class="token punctuation">:</span><span class="token punctuation">.</span><span class="token function">insert</span> <span class="token punctuation">(</span><span class="token string">&quot;u&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>_u<span class="token punctuation">.</span><span class="token function">to!</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Config<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            d
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">def</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token function">Bar</span> <span class="token punctuation">(</span><span class="token path">Foo</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token string">&quot;Test&quot;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token path">Foo</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token other-keyword">new</span> <span class="token punctuation">(</span><span class="token string">&quot;Test2&quot;</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token function">println</span> <span class="token punctuation">(</span><span class="token path">toml</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token path">dump</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">to!</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Config<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><br>
Results : </p>
<pre class="language-"><code>
[A]
u = 12
v = &quot;Test&quot;

[B]
u = 34
v = &quot;Test2&quot;
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="hashable.html" class="navigation navigation-prev " aria-label="Previous page: Hashable">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../templates/operators.html" class="navigation navigation-next " aria-label="Next page: Operator overloading">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Packable and Serializable","level":"1.12.5","depth":2,"next":{"title":"Operator overloading","level":"1.13","depth":1,"path":"templates/operators.md","ref":"templates/operators.md","articles":[{"title":"Unary, binary and Comparison","level":"1.13.1","depth":2,"path":"templates/binary.md","ref":"templates/binary.md","articles":[]},{"title":"Access, contains and iteration","level":"1.13.2","depth":2,"path":"templates/complex_operators.md","ref":"templates/complex_operators.md","articles":[]}]},"previous":{"title":"Hashable","level":"1.12.4","depth":2,"path":"traits/hashable.md","ref":"traits/hashable.md","articles":[]},"dir":"ltr"},"config":{"plugins":["prism","-highlight","katex","codeblock-filename","spoiler","folding-menu","language-picker","anchor-nav-x","code"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{"css":["themes/code.css"]},"spoiler":{},"language-picker":{"grid-columns":3},"search":{},"folding-menu":{"animationDuration":400,"sticky":false},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code":{"copyButtons":true},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"anchor-navigation-ex":{"isRewritePageTitle":false,"toolTipMode":"click"},"codeblock-filename":{},"anchor-nav-x":{"associatedWithSummary":true,"float":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showLevel":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"en","gitbook":"*"},"file":{"path":"traits/serialize.md","mtime":"2021-06-17T06:30:48.374Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-07-29T15:21:12.835Z"},"basePath":"..","book":{"language":"en"}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-spoiler/spoiler.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-folding-menu/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-language-picker/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-anchor-nav-x/lib/handler.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

