<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Aliases - Ymir Tour</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="../">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme -->
        
        <link rel="stylesheet" href="custom.css">
        

        

        <!-- Fetch Clipboard.js from CDN but have a local fallback -->
        <script src="https://cdn.jsdelivr.net/clipboard.js/1.6.1/clipboard.min.js"></script>
        <script>
            if (typeof Clipboard == 'undefined') {
                document.write(unescape("%3Cscript src='clipboard.min.js'%3E%3C/script%3E"));
            }
        </script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>

        <!-- Fetch store.js from local - TODO add CDN when 2.x.x is available on cdnjs -->
        <script src="store.js"></script>

    </head>
    <body class="light">
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = store.get('mdbook-theme');
            if (theme === null || theme === undefined) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = store.get('mdbook-sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li><a href="README.html"><strong>1.</strong> Introduction</a></li><li><a href="hello-world/README.html"><strong>2.</strong> Hello World</a></li><li><ul class="section"><li><a href="hello-world/commentaires.html"><strong>2.1.</strong> Comments</a></li></ul></li><li><a href="primitives/README.html"><strong>3.</strong> Basic programming concepts</a></li><li><ul class="section"><li><a href="primitives/variables.html"><strong>3.1.</strong> Variable and Mutability</a></li><li><a href="primitives/types.html"><strong>3.2.</strong> Data types</a></li><li><a href="primitives/functions.html"><strong>3.3.</strong> Functions</a></li><li><a href="primitives/control.html"><strong>3.4.</strong> Control flows</a></li><li><a href="primitives/operator.html"><strong>3.5.</strong> Operator priority</a></li></ul></li><li><a href="advanced/README.html"><strong>4.</strong> Alias, References and Purity</a></li><li><ul class="section"><li><a href="advanced/references.html"><strong>4.1.</strong> References</a></li><li><a href="advanced/alias.html" class="active"><strong>4.2.</strong> Aliases</a></li><li><a href="advanced/copies.html"><strong>4.3.</strong> Copy and Deep copy</a></li><li><a href="advanced/best.html"><strong>4.4.</strong> Best practice</a></li><li><a href="advanced/pure.html"><strong>4.5.</strong> Pure values</a></li></ul></li><li><a href="modules/README.html"><strong>5.</strong> Modules</a></li><li><a href="types/README.html"><strong>6.</strong> User defined types</a></li><li><ul class="section"><li><a href="types/struct.html"><strong>6.1.</strong> Structure</a></li><li><a href="types/enum.html"><strong>6.2.</strong> Enum</a></li><li><a href="types/aka.html"><strong>6.3.</strong> Aka</a></li></ul></li><li><a href="objects/README.html"><strong>7.</strong> Objects</a></li><li><ul class="section"><li><a href="objects/class.html"><strong>7.1.</strong> Class</a></li><li><a href="objects/mutability.html"><strong>7.2.</strong> Mutability</a></li><li><a href="objects/methods.html"><strong>7.3.</strong> Methods</a></li><li><a href="objects/inheritance.html"><strong>7.4.</strong> Inheritance</a></li><li><a href="objects/traits.html"><strong>7.5.</strong> Traits</a></li><li><a href="objects/cast.html"><strong>7.6.</strong> Cast, and dynamic typing</a></li></ul></li><li><a href="functions/README.html"><strong>8.</strong> Function advanced</a></li><li><a href="pattern/README.html"><strong>9.</strong> Pattern matching</a></li><li><a href="errors/main.html"><strong>10.</strong> Error handling</a></li><li><ul class="section"><li><a href="errors/scope_guards.html"><strong>10.1.</strong> Scope guards</a></li><li><a href="errors/catching.html"><strong>10.2.</strong> Catching</a></li><li><a href="errors/option.html"><strong>10.3.</strong> Exception and option type</a></li><li><a href="errors/fptr_closure.html"><strong>10.4.</strong> Unsafe function pointer</a></li></ul></li><li><a href="templates/README.html"><strong>11.</strong> Templates</a></li><li><ul class="section"><li><a href="templates/special.html"><strong>11.1.</strong> Template types</a></li><li><a href="templates/cte.html"><strong>11.2.</strong> Template values</a></li><li><a href="templates/values.html"><strong>11.3.</strong> Compilation time execution</a></li></ul></li><li><a href="objects/common_traits.html"><strong>12.</strong> Common traits</a></li><li><ul class="section"><li><a href="traits/streamable.html"><strong>12.1.</strong> Streamable</a></li><li><a href="traits/copiable.html"><strong>12.2.</strong> Copiable</a></li><li><a href="traits/disposable.html"><strong>12.3.</strong> With guard and Disposable</a></li><li><a href="traits/hashable.html"><strong>12.4.</strong> Hashable</a></li><li><a href="traits/serialize.html"><strong>12.5.</strong> Packable and Serializable</a></li></ul></li><li><a href="templates/operators.html"><strong>13.</strong> Operator overloading</a></li><li><ul class="section"><li><a href="templates/binary.html"><strong>13.1.</strong> Unary, binary and Comparison</a></li><li><a href="templates/complex_operators.html"><strong>13.2.</strong> Access, contains and iteration</a></li></ul></li><li><a href="version/README.html"><strong>14.</strong> Version</a></li><li><a href="macros/README.html"><strong>15.</strong> Macro</a></li><li><ul class="section"><li><a href="macros/std.html"><strong>15.1.</strong> Std and Core macros</a></li></ul></li><li><a href="documentation/README.html"><strong>16.</strong> Documentation</a></li><li><ul class="section"><li><a href="documentation/types.html"><strong>16.1.</strong> Types</a></li><li><a href="documentation/symbols.html"><strong>16.2.</strong> Symbols</a></li></ul></li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page" tabindex="-1">
                
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars" title="Toggle sidebar"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush" title="Change theme"></i>
                    </div>

                    <h1 class="menu-title">Ymir Tour</h1>

                    <div class="right-buttons">
                        <a href="print.html">
                            <i id="print-button" class="fa fa-print" title="Print this book"></i>
                        </a>
                    </div>
                </div>

                <div id="content" class="content">
                    <a class="header" href="advanced/alias.html#alias" id="alias"><h1>Alias</h1></a>
<p>All types that containing a pointer to data in the heap (or the stack)
are aliasable types. An aliasable type cannot be implicitly copied,
nor can it be implicitly referenced, for performance and security
reasons respectively. There are mainly three aliasable types, arrays
(or slices, there is no difference in <em>Ymir</em>), pointers, and
objects. Structures and tuples containing aliasable types are also
aliasable.</p>
<p>The keyword <strong><code>alias</code></strong> is used to inform the compiler that the used
understand that the data borrowed by a variable (or a value) will
borrowed by another values.</p>
<pre><code class="language-ymir">import std::io

def main () {
    let mut x : [mut i32] = [1, 2, 3];
    let mut y : [mut i32] = alias x; // allow y to borrow the value of x
    //                      ^^^^^
    // Try to remove the alias
    println (y);
}
</code></pre>
<p><br></p>
<p>This source code can be represented in memory by the following figure.</p>
<p><img src="https://gnu-ymir.github.io/Documentations/en/advanced/memory_x_alias_main.png" alt="drawing" height="500"  style="display: block; margin-left: auto;  margin-right: auto;"></p>
<p>The alias keyword is only mandatory when the variable that will borrow
the data is mutable and may impact the value. It is obvious that one
cannot borrow immutable data from a variable that is mutable. For
example, the compiler must return an error on the following code.</p>
<pre><code class="language-ymir">import std::io

def main () {
    let x = [1, 2, 3];
    let mut y : [mut i32] = alias x; // try to borrow immutable data in deeply mutable variable y  
    //                      ^^^^^
    // Try to remove the alias
    println (y);
}
</code></pre>
<p><br>
Errors:</p>
<pre><code class="language-error">Error : discard the constant qualifier is prohibited, left operand mutability level is 2 but must be at most 1
 --&gt; main.yr:(5,13)
 5  ┃     let mut y : [mut i32] = alias x; // try to borrow immutable data in deeply mutable variable y  
    ╋             ^
    ┃ Note : 
    ┃  --&gt; main.yr:(5,29)
    ┃  5  ┃     let mut y : [mut i32] = alias x; // try to borrow immutable data in deeply mutable variable y  
    ┃     ╋                             ^^^^^
    ┗━━━━━┻━ 

Error : undefined symbol y
 --&gt; main.yr:(8,14)
 8  ┃     println (y);
    ╋              ^


ymir1: fatal error: 
compilation terminated.
</code></pre>
<p><br></p>
<p>However, if the variable that will borrow the data is not mutable,
there is no need to add the keyword <strong><code>alias</code></strong>, and the compiler will
create an implicit alias, which will have no consequences.</p>
<pre><code class="language-ymir">import std::io

def main () {
    let x = [1, 2, 3];
    let y = x; // implicit alias is allowed, 'y' is immutable
    println (y);
}
</code></pre>
<p><br></p>
<p>In the last example, <strong><code>y</code></strong> can be mutable, as long as its internal
values are immutable, i.e. its type is <code>mut [i32]</code>, you can change the
value of <strong><code>y</code></strong>, but not the values it borrows. There is no problem,
the values of <strong><code>x</code></strong> will not be changed, no matter what is done with
<strong><code>y</code></strong>.</p>
<pre><code class="language-ymir">import std::io

def main () {
    let x = [1, 2, 3];
    let mut y = x; 
    // y [0] = 9;
    // Try to add the above line 
    
    y = [7, 8, 9];
    println (y);
}
</code></pre>
<p><br></p>
<p>You may have noticed that even though the literal is actually the
element that creates the data, we do not consider it to be the owner
of the data, so the keyword <strong><code>alias</code></strong> is implied when it is literal. We
consider the data to have an owner only once it has been assigned to a
variable.</p>
<p>There are other kinds of <code>alias</code> that are implicitly allowed, such
as code blocks or function calls. Those are implicit because
the alias is already made within the value of these elements.</p>
<pre><code class="language-ymir">import std::io

def foo () -&gt; dmut [i32] {
    let dmut x = [1, 2, 3];
    alias x // alias is done here and mandatory
}

def main ()
    throws &amp;AssertError
{
    let x = foo (); // no need to alias, it must have been done in the function
    assert (x == [1, 2, 3]);
}
</code></pre>
<p><br></p>
<a class="header" href="advanced/alias.html#alias-a-function-parameter" id="alias-a-function-parameter"><h2>Alias a function parameter</h2></a>
<p>As you have noticed, the keyword <strong><code>alias</code></strong>, unlike the keyword <code>ref</code>,
does not characterize a variable. The type of a variable will indicate
whether the type should be passed by alias or not, so there is no
change in the definition of the function. When the type of a parameter
is an aliasable type, this parameter can be mutable without being a
reference.</p>
<pre><code class="language-ymir">import std::io

// The function foo will be allowed to modify the internal values of y
def foo (mut y : [mut i32])
    throws &amp;OutOfArray
{
    y [0] = y [1];
    y = [8, 3, 4]; // has no impact on the x of main,
    // y is a reference to the data borrowed not to the variable x itself
}

def main ()
    throws &amp;OutOfArray, &amp;AssertError
{
    let dmut x = [1, 2, 3];
    foo (alias x);
    //   ^^^^^
    // Try to remove the alias
    assert (x == [2, 2, 3]);
}
</code></pre>
<p><br></p>
<p>As with the variable, if the function parameter cannot affect the
values that are borrowed, the alias keyword is not required.</p>
<pre><code class="language-ymir">import std::io

def foo (x : [i32]) {
    println (x); // just reads the borrowed data, but doesn't modify them
}

def main () {
    let dmut x = [1, 2, 3];	
    foo (x); // no need to alias
}
</code></pre>
<p><br></p>
<a class="header" href="advanced/alias.html#alias-in-uniform-call-syntax" id="alias-in-uniform-call-syntax"><h3>Alias in <em>uniform call syntax</em></h3></a>
<p>We have seen in the function chapter, the <em>uniform call syntax</em>. This
syntax is used to call a function using the dot operator <strong><code>.</code></strong>, by
putting the first parameter of the function on the left of the
operation. When the first parameter is of an aliasable type, the first
argument must be aliased explicitely, leading to a strange and verbose
syntax.</p>
<pre><code class="language-ymir">let dmut a = [1, 2, 3];
(alias a).foo (12); // same a foo (alias a, 12);
</code></pre>
<p><br>
To avoid verbosity, we added the operator <strong><code>:.</code></strong>, to use the
<em>uniform call syntax</em> with an aliasable first parameter.</p>
<pre><code class="language-ymir">let dmut a = [1, 2, 3];
a:.foo (12); // same as foo (alias a, 12);
</code></pre>
<p><br></p>
<p>This operator is very usefull when dealing with classes, where the
<em>uniform call syntax</em> is mandatory, as we will see in chapter
<a href="https://gnu-ymir.github.io/Documentations/en/objects/class.html">Class</a>.</p>
<a class="header" href="advanced/alias.html#special-case-of-struct-and-tuple" id="special-case-of-struct-and-tuple"><h2>Special case of struct and tuple</h2></a>
<p>In the chapter
<a href="https://gnu-ymir.github.io/Documentations/en/types/struct.html">Structure</a>
you will learn how to create a structure containing several fields of
different types. You have already learned how to make tuples. These
types are sometimes aliasable, depending on the internal type they
contain. If a tuple, or a structure, has a field whose type is aliasable,
then the tuple or structure is also aliasable.</p>
<p>The table below presents some examples of aliasable tuples :</p>
<table><thead><tr><th> Type </th><th> Aliasable </th><th> Reason </th></tr></thead><tbody>
<tr><td> (i32, i32) </td><td> false </td><td> i32 is not aliasable </td></tr>
<tr><td> ([i32],) </td><td> true </td><td> [i32] is a slice, and hence aliasable </td></tr>
<tr><td> ([i32], f64) </td><td> true </td><td> [i32] is a slice, and hence aliasable </td></tr>
<tr><td> (([i32], i32), f64) </td><td> true </td><td> [i32] is a slice, and hence aliasable </td></tr>
</tbody></table>
<p>In the introduction of this chapter we presented the notion of
<a href="https://gnu-ymir.github.io/Documentations/en/advanced/#mutability-level">Mutability
level</a>. One
can note that mutability level is not suitable for tuple, as aliasable
tuple are trees of type and not simply a list. However, this does not
change much, the compiler just check the mutability level of the inner
types of the tuple, recursively.</p>

                </div>

                <!-- Mobile navigation buttons -->
                
                    <a rel="prev" href="advanced/references.html" class="mobile-nav-chapters previous" title="Previous chapter">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="advanced/copies.html" class="mobile-nav-chapters next" title="Next chapter">
                        <i class="fa fa-angle-right"></i>
                    </a>
                

            </div>

            
                <a href="advanced/references.html" class="nav-chapters previous" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-left"></i>
                </a>
            

            
                <a href="advanced/copies.html" class="nav-chapters next" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-right"></i>
                </a>
            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <!-- Livereload script (if served using the cli tool) -->
        

        

        

        

        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS script -->
        
        <script type="text/javascript" src="custom.js"></script>
        

    </body>
</html>
